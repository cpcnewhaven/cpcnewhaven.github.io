<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Google tag (gtag.js) -->
        <script async
            src="https://www.googletagmanager.com/gtag/js?id=G-TL0WH5R1EK"></script>
        <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TL0WH5R1EK');
</script>
        <link rel="icon"
            href="https://storage.googleapis.com/cpc-public-website/web-assets/CPC%20-%20FAVICON%20-%20FALL%2024.png"
            type="image/png">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description"
            content="CPC New Haven Church - 135 Whitney Ave New Haven, CT. We are a church committed to serving and reaching the Greater New Haven area. Join us for worship and fellowship.">
        <meta name="keywords"
            content="CPC New Haven, Church, New Haven, CT, Worship, Fellowship">
        <meta name="author" content="CPC New Haven">
        <link rel="stylesheet" href="src/css/global-nav-bar.css">
        <title>Announcements | CPC New Haven Church</title>
        <link rel="stylesheet" href="./src/css/footer.css">
        <link rel="stylesheet" href="./src/css/global-body.css">
    <link rel="stylesheet" href="./src/css/global-footer-cta.css">
        <link rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    </head>
    <body>
        <nav class="main-navigation">
            <a href="index.html">Home</a>
            <a href="sundays.html">Sundays</a>
            <a href="about.html">About</a>
            <a href="podcasts.html">Podcasts</a>
            <a href="events.html">Events</a>
            <a href="community.html">Community</a>
            <a href="live.html">Live</a>
            <a href="resources.html">Resources</a>
            <a href="give.html">Give</a>
          </nav>
        </header>
    
        <!-- MOBILE HAMBURGER-->
        <div class="hamburger-menu-button-container" id="hamburgerMenu">
          <i id="closeMobileMenuButton" class="fas fa-bars"></i>
        </div>
    
        <!-- Mobile Navigation -->
        <nav class="mobile-navigation" id="mobileNavigation">
          <div class="mobile-nav-header">
            <button id="closeMenuButton" aria-label="Close menu">
              <i class="fas fa-times"></i>
            </button>
          </div>
          <ul class="mobile-nav-links">
            <li><a class="mobile-menu-link" href="index.html">Home</a></li>
            <li><a class="mobile-menu-link" href="sundays.html">Sundays</a></li>
            <li><a class="mobile-menu-link" href="about.html">About</a></li>
            <li><a class="mobile-menu-link" href="podcasts.html">Podcasts</a></li>
    
            <li>
              <a class="mobile-menu-link"
                href="announcements.html">Announcements</a>
            </li>
            <li><a class="mobile-menu-link" href="community.html">Community</a></li>
            <li><a class="mobile-menu-link" href="live.html">Live</a></li>
            <li><a class="mobile-menu-link" href="resources.html">Resources</a></li>
            <li><a class="mobile-menu-link" href="give.html">Give</a></li>
          </ul>
        </nav>
    <div class="splash-hero--events">
        <h1>Events</h1>
    </div>
        <section id="community-calendar">
            <h1>CPC Community Calendar</h1>
            <hr>
            <iframe src="https://calendar.google.com/calendar/embed?src=baf2h147ghi7nu8ifijjrt994k%40group.calendar.google.com&ctz=America%2FNew_York" style="border: 0" width="100%" height="360px" frameborder="0" scrolling="no"></iframe>
        </section>
        
        <style>
            #community-calendar {
                margin: 20px auto;
                max-width: 1440px;
                height:480px;
                padding: 10px;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                border-radius: 8px;
                background-color: #f9f9f9;
            }
        
            #community-calendar h1 {
                text-align: center;
                font-size: 1.5em;
                margin-bottom: 20px;
            }
        
            @media (max-width: 768px) {
                #community-calendar iframe {
                    height: 400px;
                }
            }
        
            @media (max-width: 480px) {
                #community-calendar iframe {
                    height: 300px;
                }
            }
        </style>

        <!-- 
        <div class="container">
            <div class="header">
                <h1>Upcoming Events</h1>
                <p>Join us for these upcoming events and gatherings</p>
            </div>
            <div id="events-container">
                <div class="loading">Loading events...</div>
            </div>
        </div>
        -->

        <style>
            .container {
                max-width: 1200px;
                margin: 0 auto;
                padding: 20px;
            }

            .header {
                text-align: center;
                margin-bottom: 40px;
            }

            .header h1 {
                color: var(--cpc-blue);
                margin-bottom: 10px;
            }

            .events-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                gap: 20px;
                padding: 20px 0;
            }

            .event-card {
                background: white;
                border-radius: 8px;
                padding: 20px;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                transition: transform 0.2s ease;
            }

            .event-card:hover {
                transform: translateY(-5px);
            }

            .event-card h2 {
                color: var(--cpc-blue);
                margin-top: 0;
                margin-bottom: 10px;
                font-size: 1.5em;
            }

            .event-card .date {
                color: #666;
                font-size: 0.9em;
                margin-bottom: 15px;
            }

            .event-card .type {
                display: inline-block;
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 0.8em;
                margin-bottom: 10px;
            }

            .type.event {
                background-color: #e8f5e9;
                color: #2e7d32;
            }

            .loading {
                text-align: center;
                padding: 20px;
                font-size: 1.2em;
                color: #666;
            }

            .error {
                text-align: center;
                padding: 20px;
                color: #c62828;
                background-color: #ffebee;
                border-radius: 8px;
                margin: 20px 0;
            }

            @media (max-width: 768px) {
                .events-grid {
                    grid-template-columns: 1fr;
                }
            }
        </style>

        <script>
            const API_BASE_URL = 'https://update-cpc.onrender.com';
            
            async function fetchEvents() {
                try {
                    const response = await fetch(`${API_BASE_URL}/api/announcements/raw`);
                    const data = await response.json();
                    // Support both array and {items: []}
                    const events = Array.isArray(data) ? data : (data.items || []);
                    displayEvents(events);
                } catch (error) {
                    console.error('Error fetching events:', error);
                    document.getElementById('events-container').innerHTML = `
                        <div class="error">
                            Failed to load events. Please try again later.
                        </div>
                    `;
                }
            }
            
            function displayEvents(events) {
                const container = document.getElementById('events-container');
                if (!events || events.length === 0) {
                    container.innerHTML = '<div class="error">No events available.</div>';
                    return;
                }
                // Sort by dateEntered
                const sortedEvents = events.sort((a, b) => new Date(a.dateEntered) - new Date(b.dateEntered));
                container.innerHTML = `
                    <div class="events-grid">
                        ${sortedEvents.map(e => `
                            <div class="event-card">
                                <span class="type ${e.type}">${e.type}</span>
                                <h2>${e.title}</h2>
                                <div class="date">${formatDate(e.dateEntered)}</div>
                                ${e.description ? `<p>${e.description}</p>` : ''}
                                ${e.featuredImage ? `<img src="${API_BASE_URL}/uploads/${e.featuredImage}" alt="${e.title}" style="max-width:100%;margin-top:10px;">` : ''}
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            function formatDate(dateString) {
                const opts = { year:'numeric', month:'long', day:'numeric' };
                return new Date(dateString).toLocaleDateString(undefined, opts);
            }
            
            document.addEventListener('DOMContentLoaded', fetchEvents);
        </script>

        <section class="general-announcements">
            <hr>
            <div class="book-pick-container">
                <h2>Pastor's Book Pick</h2>
                <div class="book-content">
                    <img
                        src="https://storage.googleapis.com/cpc-public-website/featuredIMGs/highlights/25.jpg"
                        alt="You Are Not Your Own Book Cover"
                        class="book-cover">
                    <div class="book-details">
                        <h3>You Are Not Your Own: Belonging to God in an Inhuman World</h3>
                        <p class="author">by Alan Noble</p>
                        <div class="book-description">
                            <p class="body-text">
                                This book examines many of the ways in which our culture reinforces the lie that we belong to ourselves, and then provides a road map to avoid falling into sinful traps. Written by English professor and PCA church member Alan Noble, it points out the cultural and technological habits we all form, and then encourages us to fight against them, armed with the gospel-centered truth that we actually belong to God.
                            </p>
                            <p class="body-text">
                                Noble is a clear and witty writer, with the ability to see through deeply ingrained sinful habits, giving us hope and liberation for a more godly lifestyle. Copies are in the foyer, please pay $ what you can.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <style>
            .book-pick-container {
                padding: 20px;
                margin: 20px auto;
                max-width: 1000px;
            }

            .book-pick-container h2 {
                text-align: center;
                margin-bottom: 30px;
                font-size: 2em;
            }

            .book-content {
                display: flex;
                gap: 30px;
                align-items: flex-start;
            }

            .book-cover {
                width: 100%;
                max-width: 300px;
                height: auto;
                border-radius: 8px;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            }

            .book-details {
                flex: 1;
            }

            .book-details h3 {
                margin: 0 0 10px 0;
                font-size: 1.4em;
                color: #333;
            }

            .author {
                font-style: italic;
                color: #666;
                margin-bottom: 20px;
            }

            .book-description {
                line-height: 1.6;
            }

            @media (max-width: 768px) {
                .book-content {
                    flex-direction: column;
                    align-items: center;
                    text-align: center;
                }

                .book-cover {
                    margin-bottom: 20px;
                }

                .book-pick-container {
                    padding: 15px;
                }

                .book-details h3 {
                    font-size: 1.2em;
                }
            }
        </style>
        <hr>

        <section id="footer-cta-a" class="styled-section-a">
            <div class="form-container">
                <h2>Subscribe to our Newsletter</h2>
                <p class="body-text ">Our weekly newsletter goes out on
                    Friday
                    mornings with
                    Sunday Service information, highlights, upcoming events,
                    and
                    useful links.</p>
                <form action="https://formspree.io/f/meojowwg" method="POST"
                    class="neumorphic-form">
                    <input type="text" name="name" placeholder="Your name"
                        required>
                    <!-- Added name input -->
                    <input type="email" name="email"
                        placeholder="Your email"
                        required>
                    <button type="submit">Subscribe to CPC New
                        Haven</button>
                </form>
            </div>
        </section>
        <footer>
            <div class="footer-content-logo">
              <a href="index.html">
                <img src="./assets/CPC_LOGO_24.png" alt="CPC New Haven Church"
                  class="top-splash-logo">
              </a></div>
            <p>Join us for worship and fellowship. <a href="sundays.html">Learn
                more</a></p>
      
            <p>203.777.6960 | <a
                href="mailto:admin@cpcnewhaven.org">admin@cpcnewhaven.org</a>
              | 135 Whitney Ave. New Haven CT 06510</p>
            <p>Â© 2024 Christ Presbyterian Church.</p>
      
          </footer>

        <!-- DYNAMIC ANNOUNCEMNTS -->
        <script src="./src/js/populate-navigation.js"></script>
        <script
            src="./src/js/highlights.js"></script>
        <script src="./src/js/function_toggle_mobileMenu.js"></script>
    </body>
</html>
